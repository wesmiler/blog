/* default.min.js Chen 2015-01-02 */
$(document).ready(function(){
    $(".forms .input-control input.form-control").hover(function(){
      $(this).parent('.input-control').find('.tips .alert-info').toggle();
    });

    $(".select-group ul li a").click(function(){
        var c = $(this).html();
        var v = $(this).attr('alt');
        var $p = $(this).parents('.select-group');
        var $b = $(this).parents('.input-group-btn');
        $b.find('button span:first-child').html(c);
        $p.children('input').val(v);
    });

    $(".navbar-nav li").click(function(){
      $(this).parent(".nav").children("li").removeClass("active");
      $(this).addClass("active");
    });

    $(".detail-content").each(function(i){
      var dc = $(this).html();
      $(".detail-btn:eq("+i+")").attr('data-content',dc);
      if(i==$(".detail-content").length-1){
        $(".detail-content").detach();
      }
    });

    $(".dropdown-menu li").hover(function(){
      $(this).children('ul').toggle();
    });

    /*dropdown menu list switch by prev or next to looking another data */
    $(".dropdown-menu li button").click(function(event){
      var $list = $(this).parents(".dropdown-menu").children("li");
      var sum = $list.length-3;
      var cur = parseInt($(this).attr('data'));
      var step = parseInt($(this).attr('data-toggle'));
      if ($(this).hasClass('prev') && cur <= sum){
        $(this).parent().children("button").each(function(){
            var data = parseInt($(this).attr('data'));
            $(this).attr('data',data-step);
        });

        $list.each(function(i){
          if( i <= sum){
              if( i >= (cur-step) && i < cur){
                $(this).removeClass('hide');
              }else{
                $(this).addClass('hide');
              }
          }
        });
      }else if ($(this).hasClass('next') && cur < sum){
        $(this).parent().children("button").each(function(){
            var data = parseInt($(this).attr('data'));
            $(this).attr('data',data+step);
        });

        $list.each(function(i){
          if( i <= sum){
              if( i < (cur+step) && i >= cur){
                $(this).removeClass('hide');
              }else{
                $(this).addClass('hide');
              }
          }
        });
      }
      event.stopPropagation();
    });

    $("button[data-toggle=popover], input[data-toggle=popover]").popover();
    var bk = $(".booking .nav").html();
    $(".nav-list").append(bk);
    $(".nav-list:last-child li").addClass("visible-xs");
    $(".nav-list:last-child li").addClass("visible-sm");

    if (typeof($(".form-datetime").val()) != 'undefined'){
      $(".date-control .form-datetime").datetimepicker({
              minView: 'month',
              format: "yyyy-mm-dd",
              showMeridian: true,
              language: 'zh-CN',
              autoclose: true,
              todayBtn: true,
              linkFormat: "yyyy-mm-dd",
      }).on('changeDate', function(ev){
          $(this).verify_datetime();
      });

      $(".form-datetime[name=end_date]").datetimepicker().on('click', function(ev){
          var enddate = $(this).val();
          if( enddate != ''){
            $(".form-datetime[name=start_date]").datetimepicker('setEndDate', enddate);
          }
      });

    }

    $(".submit-btn .submit").click(function(){
      $("#Dialog").modal();

    })  


    $(".date-control .add-on").click(function(){
      var dateInput = $(this).parent('.date-control').children('input.form-datetime').attr('id');
      $(this).datetimepicker({
        minView: 'month',
        format: "yyyy-mm-dd",
        showMeridian: true,
        autoclose: true,
        todayBtn: true,
        linkFormat: "yyyy-mm-dd",
        linkField: dateInput,
      });
    }).on('changeDate',function(){
        var $this = $(this).parents('.date-control').find('.form-datetime');
        $this.verify_datetime();
    });


})